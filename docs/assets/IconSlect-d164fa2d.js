import{bL as _e,bP as j,dc as we,cI as T,c0 as O,dV as M,cJ as te,c6 as $e,d as W,d1 as Ee,bm as Ie,cM as Ae,bN as Ne,aV as p,Q as y,dg as ke,aK as Ce,o as I,e as ae,f as d,a as R,aC as V,bl as a,n as Y,b as S,c as K,bQ as Ve,dD as Te,F as Be,aY as De,aZ as $,m as se,bc as oe,E as Fe,aA as Pe,w as E,bJ as X,$ as Oe,bO as Ke,aB as Le,cy as L,bZ as Me,bR as Re,_ as We,r as Ue,bg as ee}from"./index-df7e4a51.js";import"./el-scrollbar-1cd9d3fa.js";import{u as xe,E as He}from"./el-popper-d7ccd5c0.js";import{S as le,i as qe}from"./index-aa17eed7.js";import{E as ze}from"./index-344724fa.js";import{d as Ge}from"./debounce-8185d5a4.js";const Je=()=>Math.floor(Math.random()*1e4),Qe=_e({valueKey:{type:String,default:"value"},modelValue:{type:[String,Number],default:""},debounce:{type:Number,default:300},placement:{type:j(String),values:["top","top-start","top-end","bottom","bottom-start","bottom-end"],default:"bottom-start"},fetchSuggestions:{type:j([Function,Array]),default:we},popperClass:{type:String,default:""},triggerOnFocus:{type:Boolean,default:!0},selectWhenUnmatched:{type:Boolean,default:!1},hideLoading:{type:Boolean,default:!1},label:{type:String},teleported:xe.teleported,highlightFirstItem:{type:Boolean,default:!1},fitInputWidth:{type:Boolean,default:!1}}),Ze={[T]:t=>O(t),[M]:t=>O(t),[te]:t=>O(t),focus:t=>t instanceof FocusEvent,blur:t=>t instanceof FocusEvent,clear:()=>!0,select:t=>$e(t)},je=["aria-expanded","aria-owns"],Ye={key:0},Xe=["id","aria-selected","onClick"],ne="ElAutocomplete",et=W({name:ne,inheritAttrs:!1}),tt=W({...et,props:Qe,emits:Ze,setup(t,{expose:v,emit:r}){const l=t,A=Ee(),_=Ie(),m=Ae(),u=Ne("autocomplete"),o=p(),U=p(),x=p(),H=p();let q=!1,N=!1;const c=p([]),n=p(-1),z=p(""),f=p(!1),k=p(!1),h=p(!1),w=y(()=>u.b(String(Je()))),re=y(()=>_.style),g=y(()=>(c.value.length>0||h.value)&&f.value),G=y(()=>!l.hideLoading&&h.value),ue=y(()=>o.value?Array.from(o.value.$el.querySelectorAll("input")):[]),ie=async()=>{await Le(),g.value&&(z.value=`${o.value.$el.offsetWidth}px`)},ce=()=>{N=!0},pe=()=>{N=!1,n.value=-1},J=Ge(async e=>{if(k.value)return;const s=i=>{h.value=!1,!k.value&&(L(i)?(c.value=i,n.value=l.highlightFirstItem?0:-1):Me(ne,"autocomplete suggestions must be an array"))};if(h.value=!0,L(l.fetchSuggestions))s(l.fetchSuggestions);else{const i=await l.fetchSuggestions(e,s);L(i)&&s(i)}},l.debounce),de=e=>{const s=!!e;if(r(M,e),r(T,e),k.value=!1,f.value||(f.value=s),!l.triggerOnFocus&&!e){k.value=!0,c.value=[];return}J(e)},fe=e=>{var s;m.value||(((s=e.target)==null?void 0:s.tagName)!=="INPUT"||ue.value.includes(document.activeElement))&&(f.value=!0)},ge=e=>{r(te,e)},ve=e=>{N||(f.value=!0,r("focus",e),l.triggerOnFocus&&!q&&J(String(l.modelValue)))},me=e=>{N||r("blur",e)},he=()=>{f.value=!1,r(T,""),r("clear")},Q=async()=>{g.value&&n.value>=0&&n.value<c.value.length?B(c.value[n.value]):l.selectWhenUnmatched&&(r("select",{value:l.modelValue}),c.value=[],n.value=-1)},be=e=>{g.value&&(e.preventDefault(),e.stopPropagation(),C())},C=()=>{f.value=!1},ye=()=>{var e;(e=o.value)==null||e.focus()},Se=()=>{var e;(e=o.value)==null||e.blur()},B=async e=>{r(M,e[l.valueKey]),r(T,e[l.valueKey]),r("select",e),c.value=[],n.value=-1},D=e=>{if(!g.value||h.value)return;if(e<0){n.value=-1;return}e>=c.value.length&&(e=c.value.length-1);const s=U.value.querySelector(`.${u.be("suggestion","wrap")}`),b=s.querySelectorAll(`.${u.be("suggestion","list")} li`)[e],F=s.scrollTop,{offsetTop:Z,scrollHeight:P}=b;Z+P>F+s.clientHeight&&(s.scrollTop+=P),Z<F&&(s.scrollTop-=P),n.value=e,o.value.ref.setAttribute("aria-activedescendant",`${w.value}-item-${n.value}`)};return ke(H,()=>{g.value&&C()}),Ce(()=>{o.value.ref.setAttribute("role","textbox"),o.value.ref.setAttribute("aria-autocomplete","list"),o.value.ref.setAttribute("aria-controls","id"),o.value.ref.setAttribute("aria-activedescendant",`${w.value}-item-${n.value}`),q=o.value.ref.hasAttribute("readonly")}),v({highlightedIndex:n,activated:f,loading:h,inputRef:o,popperRef:x,suggestions:c,handleSelect:B,handleKeyEnter:Q,focus:ye,blur:Se,close:C,highlight:D}),(e,s)=>(I(),ae(a(He),{ref_key:"popperRef",ref:x,visible:a(g),placement:e.placement,"fallback-placements":["bottom-start","top-start"],"popper-class":[a(u).e("popper"),e.popperClass],teleported:e.teleported,"gpu-acceleration":!1,pure:"","manual-mode":"",effect:"light",trigger:"click",transition:`${a(u).namespace.value}-zoom-in-top`,persistent:"",onBeforeShow:ie,onShow:ce,onHide:pe},{content:d(()=>[R("div",{ref_key:"regionRef",ref:U,class:V([a(u).b("suggestion"),a(u).is("loading",a(G))]),style:Y({[e.fitInputWidth?"width":"minWidth"]:z.value,outline:"none"}),role:"region"},[S(a(ze),{id:a(w),tag:"ul","wrap-class":a(u).be("suggestion","wrap"),"view-class":a(u).be("suggestion","list"),role:"listbox"},{default:d(()=>[a(G)?(I(),K("li",Ye,[S(a(Ve),{class:V(a(u).is("loading"))},{default:d(()=>[S(a(Te))]),_:1},8,["class"])])):(I(!0),K(Be,{key:1},De(c.value,(i,b)=>(I(),K("li",{id:`${a(w)}-item-${b}`,key:b,class:V({highlighted:n.value===b}),role:"option","aria-selected":n.value===b,onClick:F=>B(i)},[$(e.$slots,"default",{item:i},()=>[se(oe(i[e.valueKey]),1)])],10,Xe))),128))]),_:3},8,["id","wrap-class","view-class"])],6)]),default:d(()=>[R("div",{ref_key:"listboxRef",ref:H,class:V([a(u).b(),e.$attrs.class]),style:Y(a(re)),role:"combobox","aria-haspopup":"listbox","aria-expanded":a(g),"aria-owns":a(w)},[S(a(Fe),Pe({ref_key:"inputRef",ref:o},a(A),{"model-value":e.modelValue,onInput:de,onChange:ge,onFocus:ve,onBlur:me,onClear:he,onKeydown:[s[0]||(s[0]=E(X(i=>D(n.value-1),["prevent"]),["up"])),s[1]||(s[1]=E(X(i=>D(n.value+1),["prevent"]),["down"])),E(Q,["enter"]),E(C,["tab"]),E(be,["esc"])],onMousedown:fe}),Oe({_:2},[e.$slots.prepend?{name:"prepend",fn:d(()=>[$(e.$slots,"prepend")])}:void 0,e.$slots.append?{name:"append",fn:d(()=>[$(e.$slots,"append")])}:void 0,e.$slots.prefix?{name:"prefix",fn:d(()=>[$(e.$slots,"prefix")])}:void 0,e.$slots.suffix?{name:"suffix",fn:d(()=>[$(e.$slots,"suffix")])}:void 0]),1040,["model-value","onKeydown"])],14,je)]),_:3},8,["visible","placement","popper-class","teleported","transition"]))}});var at=Ke(tt,[["__file","/home/runner/work/element-plus/element-plus/packages/components/autocomplete/src/autocomplete.vue"]]);const st=Re(at);const ot=W({name:"IconSelect",components:{SvgIcon:le},props:{name:{type:String,default:""},isShow:{type:Boolean,default:!1}},emits:["change"],setup(t,{emit:v}){const r=Ue({isShow:ee(t,"isShow"),name:ee(t,"name")}),l=y({get(){return r.name},set(_){v("change",_)}});function A(_,m){m(qe.map(u=>({value:u.name})))}return{dataContainer:r,iconName:l,getIconDataList:A}}}),lt={class:"item"};function nt(t,v,r,l,A,_){const m=le,u=st;return I(),ae(u,{modelValue:t.iconName,"onUpdate:modelValue":v[0]||(v[0]=o=>t.iconName=o),"fetch-suggestions":t.getIconDataList,style:{width:"100%"},disabled:t.dataContainer.isShow,"hide-loading":!0,"popper-class":"icon-select-cp-item",placeholder:""},{suffix:d(()=>[S(m,{style:"width:20px;height:20px;",name:t.iconName},null,8,["name"])]),default:d(o=>[R("div",lt,[S(m,{style:"width:15px;height:15px;margin-right:10px;",name:o.item.value},null,8,["name"]),se(" "+oe(o.item.value),1)])]),_:1},8,["modelValue","fetch-suggestions","disabled"])}const gt=We(ot,[["render",nt],["__scopeId","data-v-3681bcbb"]]);export{gt as I};
